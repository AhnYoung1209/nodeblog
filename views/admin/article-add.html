
{% extends 'layout.html' %}
{% set title={title:"添加文章"} %}
{% block style %}
<link rel="stylesheet" href="/public/js/easy-markdown-master/lib/editor.css">
{% endblock %}
{% block main %}
<!--标题-->
<div class="content-title">
    <h3>文章管理</h3>
    <div>
        <ol class="breadcrumb">
            <li>Home</li>
            <li>文章管理</li>
            <li class="active">添加文章</li>
        </ol>
    </div>
</div>
<!--列表-->
<!--发布文章-->
<div class="add-active">
    <form class="form-horizontal" method="post" action="">
        <div class="form-group">
            <!--<label for="title" class="col-sm-1 col-xs-2 control-label">标题:</label>-->
            <div class="col-sm-6 col-xs-6">
                <input type="text" class="form-control" id="title" name="title" placeholder="请输入标题">
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-12">
                <div id="layout">
                    <div id="editor">
                        <textarea name="mark" id="mark" autofocus placeholder="Markdown"></textarea>
                    </div>
                    <div id="preview"></div>
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-offset-2 col-sm-10">
                <div class="checkbox">
                    <label>
                        <input type="checkbox"> 记住密码！
                    </label>
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-offset-2 col-sm-10">
                <input type="submit" class="btn btn-default"  id="submit" value="发布">
            </div>
        </div>
    </form>
</div>
{% endblock %}
{% block script %}
<script src="/public/js/easy-markdown-master/lib/easy-markdown.js"></script>
<script>
    $(document).ready(function(){
        document.getElementById("mark").addEventListener("keyup", function () {
            var markdown = new Reader("mark");
            markdown.showHtml("preview");
        });
        $("#submit").click(function(){
            var title = $("#title").val();
//            console.log(title)
            var markdown = new Reader("mark");

            //以数组形式获得所有文本
            var mark = markdown.getHtml();

            $.ajax({
                type:'post',
                url:'/admin/article/add',
                data:{
                    title:title,
                    content:mark,
                    editer:"0",
                }
            })
            return false;
        })
    })
</script>
{% endblock %}